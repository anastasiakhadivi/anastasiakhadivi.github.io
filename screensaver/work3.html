<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<style>
			body{
				background-color: #c1d4f2;
				height: 100%;
			}
			.circle_container{
				width: 100vw;
				height: 100vh;
/*				margin: 0 auto;*/
/*				outline: 1px solid pink;*/
				display:flex;
				justify-content:center;
				align-items:center;

			}
			.circle{
				margin-top: 0;
				width: 1vw;
				height: 1vw;
				border-radius: 50%;
				border:4px solid white;
				position: absolute;

				/*margin:0 auto;*/
			}
			.circle:first-child{
				outline: 1px solid blue;
			}
			.circle:nth-child(2){
				outline:1px solid red;
			}
			.circle:nth-child(3){
				outline:1px solid yellow;
			}
			.circle:nth-child(4){
				outline: 1px solid pink;
			}
		</style>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<script>
			$(document).ready(function(){

				var numOfCircle = 4;



				for (var i=0; i<numOfCircle; i=i+1)
					$(".circle_container").append("<div class='circle'></div>");

				$(".circle:nth-child(2),.circle:nth-child(3), .circle:nth-child(4)").hide();

			
				animateCircles().done(function(){
					executeAfterCircle1();
				})
				animateCircles2().done(function(){
					executeAfterCircle2();
				})

				animateCircles3().done(function(){
					executeAfterCircle3();
				})
				animateCircles4().done(function(){
					executeAfterCircle4();
				})


				function executeAfterCircle1(){
					console.log("adding second circle");
					$(".circle:nth-child(2)").show();
					animateCircles2();
				}

				function executeAfterCircle2(){
					console.log("adding third circle");
					$(".circle:nth-child(3)").show();
					animateCircles3();
				}
				function executeAfterCircle3(){
					console.log("adding fourth circle");
					$(".circle:nth-child(4)").show();
					animateCircles4();				
				}
				function executeAfterCircle4(){
					console.log("cycle done!");
					$(".circle:nth-child(2), .circle:nth-child(3), .circle:nth-child(4)").hide();
					animateCircles();
				}

				function animateCircles(){
					var deferred = $.Deferred();
					$(".circle:first-child").animate({
						'width' : '30vw',
						'height': '30vw'
					},4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000,'linear',function(){
						deferred.resolve();
					})

					return deferred.promise();
					// console.log(animateCircles);
				}
				function animateCircles2(){
					var deferred = $.Deferred();
					$(".circle:nth-child(2)").animate({
						'width' : '40vw',
						'height': '40vw'
					}, 4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000, 'linear');
					$(".circle:first-child").animate({
						'width' : '35vw',
						'height': '35vw'
					},4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000,'linear', function(){
						deferred.resolve();
					})
					return deferred.promise();
				}
				function animateCircles3(){
					var deferred = $.Deferred();
					$(".circle:nth-child(3)").animate({
						'width' : '44vw',
						'height': '44vw'
					}, 4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000, 'linear');
					$(".circle:nth-child(2)").animate({
						'width' : '40vw',
						'height': '40vw'
					}, 4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000, 'linear');
					$(".circle:first-child").animate({
						'width' : '35vw',
						'height': '35vw'
					},4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000,'linear', function(){
						deferred.resolve();
					})
					return deferred.promise();
				}
				function animateCircles4(){

					var deferred = $.Deferred();
					$(".circle:nth-child(4)").animate({
						'width' : '50vw',
						'height': '50vw'
					}, 4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000, 'linear');
					$(".circle:nth-child(3)").animate({
						'width' : '44vw',
						'height': '44vw'
					}, 4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000, 'linear');
					$(".circle:nth-child(2)").animate({
						'width' : '40vw',
						'height': '40vw'
					}, 4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000, 'linear');
					$(".circle:first-child").animate({
						'width' : '35vw',
						'height': '35vw'
					},4000, 'linear')
					.delay(7000)
					.animate({
						'height' : '1vw',
						'width' :'1vw'
					}, 8000,'linear',function(){
						deferred.resolve();
					})
					return deferred.promise();
				}

				



// element.delay(1000).show(0)


			});

			// var animationCount = animationCount + 1;
			// console.log(animationCount);
		</script>
	</head>
	<body>
		<div class="circle_container">
			
			<!-- <div class="circle"> -->
				
			</div>
		</div>
	</body>
</html>